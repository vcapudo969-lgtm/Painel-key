<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Key Generator PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-950 text-white">

<script>
/* ===== INIT ===== */
const PLANS = {
  "24h": {h:24,c:1},
  "3d": {h:72,c:5},
  "5d": {h:120,c:10},
  "15d": {h:360,c:20},
  "30d": {h:720,c:30}
}

let users = JSON.parse(localStorage.getItem('users')) || {}
let keys = JSON.parse(localStorage.getItem('keys')) || []

if(!users.admin){
  users.admin={pass:'admin123',role:'admin',credits:Infinity,banned:false}
  localStorage.setItem('users',JSON.stringify(users))
}

let user = sessionStorage.getItem('user')
let role = sessionStorage.getItem('role')

/* ===== HELPERS ===== */
function save(){localStorage.setItem('users',JSON.stringify(users));localStorage.setItem('keys',JSON.stringify(keys))}
function logout(){sessionStorage.clear();location.reload()}
function status(k){
 if(k.paused) return '‚è∏ Pausada'
 if(Date.now()>k.expires) return '‚åõ Expirada'
 return '‚úÖ Ativa'
}
</script>

<!-- LOGIN -->
<div id="login" class="min-h-screen flex items-center justify-center">
<div class="bg-gray-900 p-6 rounded-xl w-full max-w-md">
<h1 class="text-xl font-bold text-center mb-4">Key Generator PRO</h1>
<input id="lu" class="w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Usu√°rio">
<input id="lp" type="password" class="w-full p-2 mb-3 bg-gray-800 rounded" placeholder="Senha">
<button onclick="login()" class="w-full bg-blue-600 p-2 rounded">Entrar</button>
<p class="text-center mt-2 text-sm">N√£o tem conta? <button onclick="reg()" class="text-blue-400">Registrar</button></p>
<p id="err" class="text-red-500 text-center mt-2"></p>
</div>
</div>

<!-- APP -->
<div id="app" class="hidden">

<!-- MENU -->
<div class="bg-gray-900 p-4 flex justify-between">
<button onclick="menu()" class="text-xl">‚ò∞</button>
<div>
<span id="info"></span>
<button onclick="logout()" class="ml-3 text-red-400">Sair</button>
</div>
</div>

<div id="menu" class="hidden bg-gray-800 p-4 space-y-2"></div>

<div id="content" class="p-4"></div>
</div>

<script>
/* ===== LOGIN / REGISTER ===== */
function login(){
 let u=lu.value,p=lp.value
 if(!users[u]||users[u].pass!==p||users[u].banned){err.innerText='Login inv√°lido';return}
 sessionStorage.setItem('user',u)
 sessionStorage.setItem('role',users[u].role)
 location.reload()
}

function reg(){
 let u=prompt('Usu√°rio:'),p=prompt('Senha:')
 if(!u||!p||users[u])return
 users[u]={pass:p,role:'user',credits:5,banned:false}
 save();alert('Registrado com 5 cr√©ditos')
}

/* ===== MENU ===== */
function menu(){
 menuDiv.innerHTML=''
 menuDiv.classList.toggle('hidden')
 if(role==='admin'){
 menuDiv.innerHTML+=btn('Gerenciar Usu√°rios',usersPanel)
 menuDiv.innerHTML+=btn('Gerenciar Keys',keysPanel)
 }else{
 menuDiv.innerHTML+=btn('Gerar Key',genPanel)
 menuDiv.innerHTML+=btn('Minhas Keys',myKeys)
 }
}
function btn(t,f){return `<button onclick="${f.name}()" class="block w-full bg-gray-700 p-2 rounded">${t}</button>`}

/* ===== USER ===== */
function genPanel(){
 content.innerHTML=`
 <h2 class="text-lg mb-2">Gerar Key</h2>
 <input id="pref" class="w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Prefixo">
 <select id="plan" class="w-full p-2 bg-gray-800 rounded">
 <option value="24h">24h (1)</option>
 <option value="3d">3 dias (5)</option>
 <option value="5d">5 dias (10)</option>
 <option value="15d">15 dias (20)</option>
 <option value="30d">30 dias (30)</option>
 </select>
 <button onclick="gen()" class="mt-3 bg-blue-600 w-full p-2 rounded">Gerar</button>`
}

function gen(){
 let p=PLANS[plan.value]
 if(users[user].credits<p.c){alert('Sem cr√©ditos');return}
 let k=(pref.value||'KEY')+'-'+crypto.randomUUID().slice(0,10).toUpperCase()
 keys.push({key:k,owner:user,expires:Date.now()+p.h*3600000,paused:false})
 users[user].credits-=p.c;save();alert(k)
}

function myKeys(){
 content.innerHTML='<h2 class="text-lg mb-2">Minhas Keys</h2>'
 keys.filter(k=>k.owner===user).forEach(k=>{
 content.innerHTML+=`<div class="bg-gray-800 p-2 rounded mb-2">${k.key}<br>${status(k)}</div>`
 })
}

/* ===== ADMIN ===== */
function usersPanel(){
 content.innerHTML='<h2 class="text-lg mb-2">Usu√°rios</h2>'
 Object.keys(users).forEach(u=>{
 if(u==='admin')return
 content.innerHTML+=`
 <div class="bg-gray-800 p-2 rounded mb-2">
 ${u} | Cr√©ditos: ${users[u].credits}
 <button onclick="users['${u}'].credits+=10;save();usersPanel()" class="ml-2 text-green-400">+10</button>
 <button onclick="users['${u}'].banned=true;save();usersPanel()" class="ml-2 text-red-400">Banir</button>
 </div>`
 })
}

function keysPanel(){
 content.innerHTML='<h2 class="text-lg mb-2">Keys</h2>'
 keys.forEach((k,i)=>{
 content.innerHTML+=`
 <div class="bg-gray-800 p-2 rounded mb-2">
 ${k.key} (${k.owner}) - ${status(k)}
 <button onclick="k.paused=!k.paused;save();keysPanel()" class="ml-2">‚è∏</button>
 <button onclick="k.expires=Date.now()+86400000;save();keysPanel()" class="ml-2">üîÑ</button>
 </div>`
 })
}

/* ===== START ===== */
if(user){
 login.classList.add('hidden')
 app.classList.remove('hidden')
 info.innerText=user+' | Cr√©ditos: '+(users[user].credits===Infinity?'‚àû':users[user].credits)
}
</script>

</body>
</html>
