<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Key Generator PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#020617;color:#fff}
.box{max-width:400px;margin:80px auto;background:#020617;border:1px solid #1e293b;padding:20px;border-radius:10px}
input,select,button{
  width:100%;padding:10px;margin-top:10px;
  background:#020617;color:#fff;border:1px solid #334155;border-radius:6px
}
button{background:#2563eb;border:none;font-weight:bold}
button.red{background:#dc2626}
button.gray{background:#475569}
.hidden{display:none}
.menu{background:#020617;padding:10px;border-bottom:1px solid #1e293b}
.card{background:#020617;border:1px solid #1e293b;padding:10px;margin-top:10px;border-radius:6px}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="box">
<h2>Login / Registro</h2>
<input id="loginUser" placeholder="Usuário">
<input id="loginPass" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
<button onclick="register()" class="gray">Registrar</button>
<p id="msg" style="color:red"></p>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <div class="menu">
    <button onclick="toggleMenu()">☰</button>
    <span id="userInfo"></span>
    <button onclick="logout()" class="red">Sair</button>
  </div>
  <div id="menuBox" class="hidden"></div>
  <div id="content" class="box"></div>
</div>

<script>
/* ===== DADOS ===== */
const PLANS={
  "24h":{h:24,c:1},
  "3d":{h:72,c:5},
  "5d":{h:120,c:10},
  "15d":{h:360,c:20},
  "30d":{h:720,c:30}
}

let users=JSON.parse(localStorage.getItem('users')||'{}')
let keys=JSON.parse(localStorage.getItem('keys')||'[]')

/* ===== CRIAR ADMIN SEMPRE ===== */
users.admin={pass:'admin123',role:'admin',credits:Infinity,banned:false}
localStorage.setItem('users',JSON.stringify(users))

let currentUser=sessionStorage.getItem('user')
let role=sessionStorage.getItem('role')

/* ===== LOGIN ===== */
function login(){
  const u=document.getElementById('loginUser').value.trim()
  const p=document.getElementById('loginPass').value.trim()
  const msg=document.getElementById('msg')

  if(!users[u]||users[u].pass!==p||users[u].banned){
    msg.innerText='Login inválido'
    return
  }
  sessionStorage.setItem('user',u)
  sessionStorage.setItem('role',users[u].role)
  location.reload()
}

/* ===== REGISTRO ===== */
function register(){
  const u=prompt('Usuário:')
  const p=prompt('Senha:')
  if(!u||!p||users[u])return alert('Inválido')
  users[u]={pass:p,role:'user',credits:5,banned:false}
  localStorage.setItem('users',JSON.stringify(users))
  alert('Registrado com 5 créditos')
}

/* ===== MENU ===== */
function toggleMenu(){
  const m=document.getElementById('menuBox')
  m.innerHTML=''
  m.classList.toggle('hidden')

  if(role==='admin'){
    m.innerHTML+=btn('Gerenciar Usuários','usersPanel()')
    m.innerHTML+=btn('Gerenciar Keys','keysPanel()')
  }else{
    m.innerHTML+=btn('Gerar Key','genPanel()')
    m.innerHTML+=btn('Minhas Keys','myKeys()')
  }
}

function btn(t,fn){
  return `<button onclick="${fn}" class="gray">${t}</button>`
}

/* ===== USER ===== */
function genPanel(){
  content.innerHTML=`
  <h3>Gerar Key</h3>
  <input id="prefix" placeholder="Prefixo">
  <select id="plan">
    <option value="24h">24h (1)</option>
    <option value="3d">3 dias (5)</option>
    <option value="5d">5 dias (10)</option>
    <option value="15d">15 dias (20)</option>
    <option value="30d">30 dias (30)</option>
  </select>
  <button onclick="generate()">Gerar</button>`
}

function generate(){
  const plan=PLANS[document.getElementById('plan').value]
  if(users[currentUser].credits<plan.c)return alert('Sem créditos')
  const k=(prefix.value||'KEY')+'-'+crypto.randomUUID().slice(0,10).toUpperCase()
  keys.push({key:k,owner:currentUser,expires:Date.now()+plan.h*3600000,paused:false})
  users[currentUser].credits-=plan.c
  save();alert('Key: '+k)
}

function myKeys(){
  content.innerHTML='<h3>Minhas Keys</h3>'
  keys.filter(k=>k.owner===currentUser).forEach(k=>{
    content.innerHTML+=`<div class="card">${k.key}<br>${status(k)}</div>`
  })
}

/* ===== ADMIN ===== */
function usersPanel(){
  content.innerHTML='<h3>Usuários</h3>'
  Object.keys(users).forEach(u=>{
    if(u==='admin')return
    content.innerHTML+=`
    <div class="card">
      ${u} | Créditos: ${users[u].credits}
      <button onclick="users['${u}'].credits+=10;save();usersPanel()">+10</button>
      <button onclick="users['${u}'].banned=true;save();usersPanel()" class="red">Banir</button>
    </div>`
  })
}

function keysPanel(){
  content.innerHTML='<h3>Keys</h3>'
  keys.forEach(k=>{
    content.innerHTML+=`
    <div class="card">
      ${k.key} (${k.owner})<br>${status(k)}
      <button onclick="k.paused=!k.paused;save();keysPanel()">Pausar</button>
      <button onclick="k.expires=Date.now()+86400000;save();keysPanel()">Reset</button>
    </div>`
  })
}

/* ===== UTIL ===== */
function status(k){
  if(k.paused)return'⏸ Pausada'
  if(Date.now()>k.expires)return'⌛ Expirada'
  return'✅ Ativa'
}
function save(){
  localStorage.setItem('users',JSON.stringify(users))
  localStorage.setItem('keys',JSON.stringify(keys))
}
function logout(){
  sessionStorage.clear()
  location.reload()
}

/* ===== START ===== */
if(currentUser){
  document.getElementById('loginBox').classList.add('hidden')
  document.getElementById('app').classList.remove('hidden')
  document.getElementById('userInfo').innerText=
    currentUser+' | Créditos: '+(users[currentUser].credits===Infinity?'∞':users[currentUser].credits)
}
</script>

</body>
</html> 
