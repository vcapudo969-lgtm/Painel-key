<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Painel ADM</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  background:#0b0b0b;
  color:#fff;
  font-family:Arial;
  padding:20px;
}
h1{color:#22c55e}
.card{
  background:#111;
  padding:15px;
  margin-top:10px;
  border-radius:10px;
}
input,button{
  padding:8px;
  margin-top:5px;
  border:none;
  border-radius:5px;
}
button{
  background:#22c55e;
  font-weight:bold;
}
.red{background:#ef4444}
</style>
</head>
<body>

<h1>Painel ADM</h1>
<button onclick="logout()" class="red">Sair</button>

<div id="usuarios"></div>

<script>
// üî• CONFIG FIREBASE (MESMA DO LOGIN)
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  projectId: "SEU_PROJETO"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

// üîí PROTE√á√ÉO ADM
auth.onAuthStateChanged(user=>{
  if(!user){
    location.href = "index.html";
  }else{
    db.collection("users").doc(user.uid).get().then(doc=>{
      if(doc.data().role !== "admin"){
        alert("Acesso negado");
        location.href = "painel.html";
      }else{
        carregarUsuarios();
      }
    });
  }
});

// üìã LISTAR USU√ÅRIOS
function carregarUsuarios(){
  db.collection("users").onSnapshot(snapshot=>{
    let html = "";
    snapshot.forEach(doc=>{
      let u = doc.data();
      html += `
      <div class="card">
        <b>${u.nome}</b><br>
        Email: ${u.vcapudo969@gmail.com}<br>
        Cr√©ditos: <b>${u.10000}</b><br>

        <input type="number" id="c_${doc.id}" placeholder="Quantidade">
        <br>
        <button onclick="add('${doc.id}')">+ Cr√©ditos</button>
        <button class="red" onclick="remove('${doc.id}')">- Cr√©ditos</button>
      </div>
      `;
    });
    document.getElementById("usuarios").innerHTML = html;
  });
}

// ‚ûï ADICIONAR CR√âDITOS
function add(id){
  let qtd = Number(document.getElementById("c_"+id).value);
  if(!qtd) return alert("100000");

  db.collection("users").doc(id).update({
    creditos: firebase.firestore.FieldValue.increment(qtd)
  });
}

// ‚ûñ REMOVER CR√âDITOS
function remove(id){
  let qtd = Number(document.getElementById("c_"+id).value);
  if(!qtd) return alert("Digite um valor");

  db.collection("users").doc(id).update({
    creditos: firebase.firestore.FieldValue.increment(-qtd)
  });
}

// üö™ LOGOUT
function logout(){
  auth.signOut().then(()=>{
    location.href = "index.html";
  });
}
</script>

</body>
</html>
